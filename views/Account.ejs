<% include partials/head %>

<div class="container-with-menu container">
	<div class="row row-height">
		<div class="menu col-3">
			<ul>
				<li>
					<a href="#" onclick="openTab(event, this, 'login')" class="menu-link active disabled"><i class="fas fa-sign-in-alt mr-2"></i> Connexion <i class="fas fa-chevron-right chev"></i></a>
				</li>
				<li>
					<a href="#" onclick="openTab(event, this, 'lostpw-container')" class="menu-link"
						><i class="fas fa-key mr-2"></i>
						<span style="font-size: 20px;">Mot de passe oublié</span>
						<i class="fas fa-chevron-right chev"></i
					></a>
				</li>
			</ul>
		</div>

		<div id="login" class="tab col-9 row">
			<div class="container" id="container">
				<div class="form-slider-container sign-up-container">
					<form class="form-slider" id="register" onsubmit="submitRegister(event)" method="POST" action="/api/auth/register">
						<h1>S'inscrire</h1>

						<input placeholder="Jean75" type="text" name="name" id="name" onkeyup="Validate.String(this, 4, 30);" value="<% if (locals.formData) { %><%= locals.formData.name %><% } %>" required />
						<span id="i_name" class="form-info">Username must contain between 4 and 30 characters</span>

						<input
							placeholder="jeandupont@gmail.com"
							type="email"
							name="email"
							id="email"
							onkeyup="Validate.Email(this);"
							value="<% if (locals.formData) { %><%= locals.formData.email %><% } %>"
							required
						/>
						<span id="i_email" class="form-info">E-mail has to be valid</span>

						<input placeholder="Mot de passe" type="password" name="password" id="password" onkeyup="Validate.Password(this);" required />
						<span id="i_password" class="form-info">Password must contain between 8 and 256 characters and has to beatleast alphanumeric</span>

						<input placeholder="Mot de passe (confirmation)" type="password" name="password2" id="password2" onkeyup="Validate.Password2(this);" required />
						<span id="i_password2" class="form-info">Password has to be the same as the one you just entered</span>

						<div class="recaptcha-wrapper"></div>
						<input type="hidden" name="_csrf" value="<%= locals.csrfToken %>" />
						<input type="submit" class="logbtn" value="Inscription" id="submit-register" />
					</form>
				</div>

				<div class="form-slider-container sign-in-container">
					<form class="form-slider" id="login-form" method="POST" onsubmit="submitLogin(event)" action="/api/auth/login">
						<h1 class="mb-3">Se connecter</h1>
						<input placeholder="Email" type="email" id="login-email" name="email" value="<% if (locals.formData) { %><%= locals.formData.email %><% } %>" required />
						<input placeholder="Mot de passe" type="password" id="login-pw" name="password" required />

						<input type="hidden" name="_csrf" value="<%= locals.csrfToken %>" />
						<div class="recaptcha-wrapper"></div>
						<input type="submit" class="logbtn" value="Connexion" id="submit-login" />
					</form>
				</div>

				<div class="overlay-container">
					<div class="overlay">
						<div class="overlay-panel overlay-left">
							<h1>Bienvenue!</h1>
							<p>Pour accéder à votre compte, connectez vous en cliquant sur ce bouton</p>
							<button class="ghost" id="signIn">Connexion</button>
						</div>
						<div class="overlay-panel overlay-right">
							<h1>Pas encore de compte?</h1>
							<p>Créez un compte en moins d'une minute</p>
							<button class="ghost" id="signUp">Inscription</button>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div id="lostpw-container" class="tab col-9" style="display: none;">
			<div class="container p-0 m-0 h-100">
				<div class="col-10 offset-1 wrapper lostpw-container">
					<div class="box-lostpw">
						<div class="section-heading">
							<h2>Password Recovery</h2>
						</div>
						<div id="alert" class="alert alert-info alert-static" role="alert">
							We'll send you a mail with instructions to reset your password
						</div>
						<form class="col-8 offset-2 mt-5" id="lostpw" onsubmit="submitLostpw(event)" method="POST" action="/api/user/lostpw">
							<input placeholder="Email" class="form-control-test" type="email" id="email-reset" name="email" value="" onkeyup="Validate.Email(this);" required />
							<span id="i_email-reset" class="form-info">E-mail has to be valid</span>

							<input type="hidden" name="_csrf" value="<%= locals.csrfToken %>" />
							<div class="text-center">
								<div class="recaptcha-wrapper"></div>
							</div>
							<input type="submit" class="logbtn" value="Envoyer" id="submit-lostpw" />
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script src="/scripts/submit-auth.js"></script>
<script src="https://www.google.com/recaptcha/api.js?onload=CaptchaCallback&render=explicit" async defer></script>
<script src="/scripts/frontValidation.js"></script>
<% include partials/footer %>
